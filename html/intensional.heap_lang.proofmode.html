<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="../">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">intensional.heap_lang.proofmode</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#"><span class="id" title="library">coq_tactics</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.reduction.html#"><span class="id" title="library">reduction</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.tactics.html#"><span class="id" title="library">tactics</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.atomic.html#"><span class="id" title="library">atomic</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">intensional.heap_lang</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="intensional.heap_lang.tactics.html#"><span class="id" title="library">tactics</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#"><span class="id" title="library">lifting</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">intensional</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="intensional.heap_lang.notation.html#"><span class="id" title="library">notation</span></a>.<br/>
<span class="id" title="keyword">Import</span> <span class="id" title="var">uPred</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_expr_eval" class="idref" href="#tac_wp_expr_eval"><span class="id" title="lemma">tac_wp_expr_eval</span></a> `{<a id="heapG0:2" class="idref" href="#heapG0:2"><span class="id" title="binder">!</span></a><a id="heapG0:2" class="idref" href="#heapG0:2"><span class="id" title="binder">heapG</span></a> <a id="heapG0:2" class="idref" href="#heapG0:2"><span class="id" title="binder">Σ</span></a>} <a id="70086898232ea9f35274651a64a6780a" class="idref" href="#70086898232ea9f35274651a64a6780a"><span class="id" title="binder">Δ</span></a> <a id="s:4" class="idref" href="#s:4"><span class="id" title="binder">s</span></a> <a id="E:5" class="idref" href="#E:5"><span class="id" title="binder">E</span></a> <a id="f4f4f3cda8233c03492a392432920388" class="idref" href="#f4f4f3cda8233c03492a392432920388"><span class="id" title="binder">Φ</span></a> <a id="e:7" class="idref" href="#e:7"><span class="id" title="binder">e</span></a> <a id="e':8" class="idref" href="#e':8"><span class="id" title="binder">e'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="e'':9" class="idref" href="#e'':9"><span class="id" title="binder">e''</span></a>:=<a class="idref" href="intensional.heap_lang.proofmode.html#e':8"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:7"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e'':9"><span class="id" title="variable">e''</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#70086898232ea9f35274651a64a6780a"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e':8"><span class="id" title="variable">e'</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:4"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:5"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f4f4f3cda8233c03492a392432920388"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#70086898232ea9f35274651a64a6780a"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:7"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:4"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:5"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f4f4f3cda8233c03492a392432920388"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_expr_eval" class="idref" href="#tac_twp_expr_eval"><span class="id" title="lemma">tac_twp_expr_eval</span></a> `{<a id="heapG0:11" class="idref" href="#heapG0:11"><span class="id" title="binder">!</span></a><a id="heapG0:11" class="idref" href="#heapG0:11"><span class="id" title="binder">heapG</span></a> <a id="heapG0:11" class="idref" href="#heapG0:11"><span class="id" title="binder">Σ</span></a>} <a id="4486f22a746bf7e8d11c811eaad4efd7" class="idref" href="#4486f22a746bf7e8d11c811eaad4efd7"><span class="id" title="binder">Δ</span></a> <a id="s:13" class="idref" href="#s:13"><span class="id" title="binder">s</span></a> <a id="E:14" class="idref" href="#E:14"><span class="id" title="binder">E</span></a> <a id="f5af5be01b05ea888980eb3fd3d8049b" class="idref" href="#f5af5be01b05ea888980eb3fd3d8049b"><span class="id" title="binder">Φ</span></a> <a id="e:16" class="idref" href="#e:16"><span class="id" title="binder">e</span></a> <a id="e':17" class="idref" href="#e':17"><span class="id" title="binder">e'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="e'':18" class="idref" href="#e'':18"><span class="id" title="binder">e''</span></a>:=<a class="idref" href="intensional.heap_lang.proofmode.html#e':17"><span class="id" title="variable">e'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:16"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e'':18"><span class="id" title="variable">e''</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#4486f22a746bf7e8d11c811eaad4efd7"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e':17"><span class="id" title="variable">e'</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:13"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:14"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f5af5be01b05ea888980eb3fd3d8049b"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#4486f22a746bf7e8d11c811eaad4efd7"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:16"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:13"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:14"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f5af5be01b05ea888980eb3fd3d8049b"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">intros</span> -&gt;. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_expr_eval" <span class="id" title="var">tactic3</span>(<span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_expr_eval"><span class="id" title="lemma">tac_wp_expr_eval</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="var">t</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">reflexivity</span>|]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_expr_eval"><span class="id" title="lemma">tac_twp_expr_eval</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span>; <span class="id" title="var">t</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">x</span>; <span class="id" title="tactic">reflexivity</span>|]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_expr_eval: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_pure" class="idref" href="#tac_wp_pure"><span class="id" title="lemma">tac_wp_pure</span></a> `{<a id="heapG0:20" class="idref" href="#heapG0:20"><span class="id" title="binder">!</span></a><a id="heapG0:20" class="idref" href="#heapG0:20"><span class="id" title="binder">heapG</span></a> <a id="heapG0:20" class="idref" href="#heapG0:20"><span class="id" title="binder">Σ</span></a>} <a id="531c023394dd914fd03e5fa3ca768114" class="idref" href="#531c023394dd914fd03e5fa3ca768114"><span class="id" title="binder">Δ</span></a> <a id="3ea4882ebc23f7a1f98c5f2e10f555f3" class="idref" href="#3ea4882ebc23f7a1f98c5f2e10f555f3"><span class="id" title="binder">Δ'</span></a> <a id="s:23" class="idref" href="#s:23"><span class="id" title="binder">s</span></a> <a id="E:24" class="idref" href="#E:24"><span class="id" title="binder">E</span></a> <a id="K:25" class="idref" href="#K:25"><span class="id" title="binder">K</span></a> <a id="e1:26" class="idref" href="#e1:26"><span class="id" title="binder">e1</span></a> <a id="e2:27" class="idref" href="#e2:27"><span class="id" title="binder">e2</span></a> <a id="b3edb256fccb76e3c292eb66d9c38347" class="idref" href="#b3edb256fccb76e3c292eb66d9c38347"><span class="id" title="binder">φ</span></a> <a id="n:29" class="idref" href="#n:29"><span class="id" title="binder">n</span></a> <a id="01a46550ac8db3a3545feae0533fc1da" class="idref" href="#01a46550ac8db3a3545feae0533fc1da"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#PureExec"><span class="id" title="class">PureExec</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#b3edb256fccb76e3c292eb66d9c38347"><span class="id" title="variable">φ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#n:29"><span class="id" title="variable">n</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e1:26"><span class="id" title="variable">e1</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e2:27"><span class="id" title="variable">e2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#b3edb256fccb76e3c292eb66d9c38347"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#n:29"><span class="id" title="variable">n</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#531c023394dd914fd03e5fa3ca768114"><span class="id" title="variable">Δ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#3ea4882ebc23f7a1f98c5f2e10f555f3"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#3ea4882ebc23f7a1f98c5f2e10f555f3"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:25"><span class="id" title="variable">K</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e2:27"><span class="id" title="variable">e2</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:23"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:24"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#01a46550ac8db3a3545feae0533fc1da"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#531c023394dd914fd03e5fa3ca768114"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:25"><span class="id" title="variable">K</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e1:26"><span class="id" title="variable">e1</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:23"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:24"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#01a46550ac8db3a3545feae0533fc1da"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ??? <span class="id" title="var">HΔ'</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HΔ'</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.lifting.html#wp_pure_step_later"><span class="id" title="lemma">lifting.wp_pure_step_later</span></a> //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_pure" class="idref" href="#tac_twp_pure"><span class="id" title="lemma">tac_twp_pure</span></a> `{<a id="heapG0:32" class="idref" href="#heapG0:32"><span class="id" title="binder">!</span></a><a id="heapG0:32" class="idref" href="#heapG0:32"><span class="id" title="binder">heapG</span></a> <a id="heapG0:32" class="idref" href="#heapG0:32"><span class="id" title="binder">Σ</span></a>} <a id="b73faf325f76646787a7bae4ee8ea0fb" class="idref" href="#b73faf325f76646787a7bae4ee8ea0fb"><span class="id" title="binder">Δ</span></a> <a id="s:34" class="idref" href="#s:34"><span class="id" title="binder">s</span></a> <a id="E:35" class="idref" href="#E:35"><span class="id" title="binder">E</span></a> <a id="K:36" class="idref" href="#K:36"><span class="id" title="binder">K</span></a> <a id="e1:37" class="idref" href="#e1:37"><span class="id" title="binder">e1</span></a> <a id="e2:38" class="idref" href="#e2:38"><span class="id" title="binder">e2</span></a> <a id="f670e0558f9ccb8c272365f4c1295f3f" class="idref" href="#f670e0558f9ccb8c272365f4c1295f3f"><span class="id" title="binder">φ</span></a> <a id="n:40" class="idref" href="#n:40"><span class="id" title="binder">n</span></a> <a id="41d18e8a2b2e573b496086c21c3c16d4" class="idref" href="#41d18e8a2b2e573b496086c21c3c16d4"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.language.html#PureExec"><span class="id" title="class">PureExec</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f670e0558f9ccb8c272365f4c1295f3f"><span class="id" title="variable">φ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#n:40"><span class="id" title="variable">n</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e1:37"><span class="id" title="variable">e1</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e2:38"><span class="id" title="variable">e2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#f670e0558f9ccb8c272365f4c1295f3f"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#b73faf325f76646787a7bae4ee8ea0fb"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:36"><span class="id" title="variable">K</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e2:38"><span class="id" title="variable">e2</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:34"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:35"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#41d18e8a2b2e573b496086c21c3c16d4"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#b73faf325f76646787a7bae4ee8ea0fb"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">(</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:36"><span class="id" title="variable">K</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e1:37"><span class="id" title="variable">e1</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:34"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:35"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#41d18e8a2b2e573b496086c21c3c16d4"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ?? -&gt;. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_lifting.html#twp_pure_step"><span class="id" title="lemma">total_lifting.twp_pure_step</span></a> //.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_value" class="idref" href="#tac_wp_value"><span class="id" title="lemma">tac_wp_value</span></a> `{<a id="heapG0:43" class="idref" href="#heapG0:43"><span class="id" title="binder">!</span></a><a id="heapG0:43" class="idref" href="#heapG0:43"><span class="id" title="binder">heapG</span></a> <a id="heapG0:43" class="idref" href="#heapG0:43"><span class="id" title="binder">Σ</span></a>} <a id="588d335e7ef83ff38b48f3b650112d02" class="idref" href="#588d335e7ef83ff38b48f3b650112d02"><span class="id" title="binder">Δ</span></a> <a id="s:45" class="idref" href="#s:45"><span class="id" title="binder">s</span></a> <a id="E:46" class="idref" href="#E:46"><span class="id" title="binder">E</span></a> <a id="001faddda1c74c479de748020de17f40" class="idref" href="#001faddda1c74c479de748020de17f40"><span class="id" title="binder">Φ</span></a> <a id="v:48" class="idref" href="#v:48"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#588d335e7ef83ff38b48f3b650112d02"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#001faddda1c74c479de748020de17f40"><span class="id" title="variable">Φ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:48"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#588d335e7ef83ff38b48f3b650112d02"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">(</span></a><a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:48"><span class="id" title="variable">v</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:45"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:46"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#001faddda1c74c479de748020de17f40"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; -&gt;. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_value"><span class="id" title="lemma">wp_value</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_value" class="idref" href="#tac_twp_value"><span class="id" title="lemma">tac_twp_value</span></a> `{<a id="heapG0:50" class="idref" href="#heapG0:50"><span class="id" title="binder">!</span></a><a id="heapG0:50" class="idref" href="#heapG0:50"><span class="id" title="binder">heapG</span></a> <a id="heapG0:50" class="idref" href="#heapG0:50"><span class="id" title="binder">Σ</span></a>} <a id="470a1afdbbe48f100e3c886f9cdd5bf9" class="idref" href="#470a1afdbbe48f100e3c886f9cdd5bf9"><span class="id" title="binder">Δ</span></a> <a id="s:52" class="idref" href="#s:52"><span class="id" title="binder">s</span></a> <a id="E:53" class="idref" href="#E:53"><span class="id" title="binder">E</span></a> <a id="b62930ba920d094619afe8ef0203354e" class="idref" href="#b62930ba920d094619afe8ef0203354e"><span class="id" title="binder">Φ</span></a> <a id="v:55" class="idref" href="#v:55"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#470a1afdbbe48f100e3c886f9cdd5bf9"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#b62930ba920d094619afe8ef0203354e"><span class="id" title="variable">Φ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:55"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#470a1afdbbe48f100e3c886f9cdd5bf9"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">(</span></a><a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:55"><span class="id" title="variable">v</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">)</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:52"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:53"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#b62930ba920d094619afe8ef0203354e"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; -&gt;. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_value"><span class="id" title="lemma">twp_value</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_expr_simpl</span> := <span class="id" title="var">wp_expr_eval</span> <span class="id" title="tactic">simpl</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_value_head</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">first</span> [<span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_value"><span class="id" title="lemma">tac_wp_value</span></a> || <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_value"><span class="id" title="lemma">tac_twp_value</span></a>].<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_finish</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_expr_simpl</span>;      <span class="comment">(*&nbsp;simplify&nbsp;occurences&nbsp;of&nbsp;subst/fill&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="var">wp_value_head</span>;  <span class="comment">(*&nbsp;in&nbsp;case&nbsp;we&nbsp;have&nbsp;reached&nbsp;a&nbsp;value,&nbsp;get&nbsp;rid&nbsp;of&nbsp;the&nbsp;WP&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">pm_prettify</span>. <span class="comment">(*&nbsp;prettify&nbsp;▷s&nbsp;caused&nbsp;by&nbsp;<span class="inlinecode"><span class="id" title="var">MaybeIntoLaterNEnvs</span></span>&nbsp;and<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;λs&nbsp;caused&nbsp;by&nbsp;wp_value&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">solve_vals_compare_safe</span> :=<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;first&nbsp;branch&nbsp;is&nbsp;for&nbsp;when&nbsp;we&nbsp;have&nbsp;<span class="inlinecode"><span class="id" title="var">vals_compare_safe</span></span>&nbsp;in&nbsp;the&nbsp;context.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;other&nbsp;two&nbsp;branches&nbsp;are&nbsp;for&nbsp;when&nbsp;either&nbsp;one&nbsp;of&nbsp;the&nbsp;branches&nbsp;reduces&nbsp;to<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"><span class="id" title="var">True</span></span>&nbsp;or&nbsp;we&nbsp;have&nbsp;it&nbsp;in&nbsp;the&nbsp;context.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">fast_done</span> || (<span class="id" title="tactic">left</span>; <span class="id" title="var">fast_done</span>) || (<span class="id" title="tactic">right</span>; <span class="id" title="var">fast_done</span>).<br/>

<br/>
</div>

<div class="doc">
The argument <span class="inlinecode"><span class="id" title="var">efoc</span></span> can be used to specify the construct that should be
reduced. For example, you can write <span class="inlinecode"><span class="id" title="var">wp_pure</span></span> <span class="inlinecode">(<span class="id" title="var">EIf</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span>)</span>, which will search
for an <span class="inlinecode"><span class="id" title="var">EIf</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> <span class="inlinecode"><span class="id" title="var">_</span></span> in the expression, and reduce it.

<div class="paragraph"> </div>

The use of <span class="inlinecode"><span class="id" title="var">open_constr</span></span> in this tactic is essential. It will convert all holes
(i.e. <span class="inlinecode"><span class="id" title="var">_</span></span>s) into evars, that later get unified when an occurences is found
(see <span class="inlinecode"><span class="id" title="var">unify</span></span> <span class="inlinecode"><span class="id" title="var">e'</span></span> <span class="inlinecode"><span class="id" title="var">efoc</span></span> in the code below). 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "wp_pure" <span class="id" title="var">open_constr</span>(<span class="id" title="var">efoc</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unify</span> <span class="id" title="var">e'</span> <span class="id" title="var">efoc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_pure"><span class="id" title="lemma">tac_wp_pure</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span>                       <span class="comment">(*&nbsp;PureExec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span>    <span class="comment">(*&nbsp;The&nbsp;pure&nbsp;condition&nbsp;for&nbsp;PureExec&nbsp;--&nbsp;handles&nbsp;trivial&nbsp;goals,&nbsp;including&nbsp;<span class="inlinecode"><span class="id" title="var">vals_compare_safe</span></span>&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">iSolveTC</span>                       <span class="comment">(*&nbsp;IntoLaters&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>                      <span class="comment">(*&nbsp;new&nbsp;goal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">fail</span> "wp_pure: cannot find" <span class="id" title="var">efoc</span> "in" <span class="id" title="var">e</span> "or" <span class="id" title="var">efoc</span> "is not a redex"<br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">e</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">unify</span> <span class="id" title="var">e'</span> <span class="id" title="var">efoc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_pure"><span class="id" title="lemma">tac_twp_pure</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span>                       <span class="comment">(*&nbsp;PureExec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span>    <span class="comment">(*&nbsp;The&nbsp;pure&nbsp;condition&nbsp;for&nbsp;PureExec&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>                      <span class="comment">(*&nbsp;new&nbsp;goal&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">fail</span> "wp_pure: cannot find" <span class="id" title="var">efoc</span> "in" <span class="id" title="var">e</span> "or" <span class="id" title="var">efoc</span> "is not a redex"<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_pure: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="comment">(*&nbsp;TODO:&nbsp;do&nbsp;this&nbsp;in&nbsp;one&nbsp;go,&nbsp;without&nbsp;<span class="inlinecode"><span class="id" title="tactic">repeat</span></span>.&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_pures</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="var">wp_pure</span> <span class="id" title="var">_</span>; []). <span class="comment">(*&nbsp;The&nbsp;`;<span class="inlinecode"></span>`&nbsp;makes&nbsp;sure&nbsp;that&nbsp;no&nbsp;side-condition<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;magically&nbsp;spawns.&nbsp;*)</span><br/>

<br/>
</div>

<div class="doc">
Unlike <span class="inlinecode"><span class="id" title="var">wp_pures</span></span>, the tactics <span class="inlinecode"><span class="id" title="var">wp_rec</span></span> and <span class="inlinecode"><span class="id" title="var">wp_lam</span></span> should also reduce
lambdas/recs that are hidden behind a definition, i.e. they should use
<span class="inlinecode"><a class="idref" href="intensional.heap_lang.lifting.html#AsRecV_recv"><span class="id" title="definition">AsRecV_recv</span></a></span> as a proper instance instead of a <span class="inlinecode"><span class="id" title="keyword">Hint</span></span> <span class="inlinecode"><span class="id" title="keyword">Extern</span></span>.

<div class="paragraph"> </div>

We achieve this by putting <span class="inlinecode"><a class="idref" href="intensional.heap_lang.lifting.html#AsRecV_recv"><span class="id" title="definition">AsRecV_recv</span></a></span> in the current environment so that it
can be used as an instance by the typeclass resolution system. We then perform
the reduction, and finally we clear this new hypothesis. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "wp_rec" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> := <a class="idref" href="intensional.heap_lang.lifting.html#AsRecV_recv"><span class="id" title="definition">AsRecV_recv</span></a>);<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.App"><span class="id" title="constructor">App</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_if" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_if_true" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_if_false" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.If"><span class="id" title="constructor">If</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_unop" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.UnOp"><span class="id" title="constructor">UnOp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_binop" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.BinOp"><span class="id" title="constructor">BinOp</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_op" := <span class="id" title="var">wp_unop</span> || <span class="id" title="var">wp_binop</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_lam" := <span class="id" title="var">wp_rec</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_let" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#BAnon"><span class="id" title="constructor">BAnon</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#BNamed"><span class="id" title="constructor">BNamed</span></a> <span class="id" title="var">_</span>) <span class="id" title="var">_</span>); <span class="id" title="var">wp_lam</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_seq" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#BAnon"><span class="id" title="constructor">BAnon</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.binders.html#BAnon"><span class="id" title="constructor">BAnon</span></a> <span class="id" title="var">_</span>); <span class="id" title="var">wp_lam</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_proj" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Fst"><span class="id" title="constructor">Fst</span></a> <span class="id" title="var">_</span>) || <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Snd"><span class="id" title="constructor">Snd</span></a> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_case" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Case"><span class="id" title="constructor">Case</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_match" := <span class="id" title="var">wp_case</span>; <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">wp_lam</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_inj" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.InjL"><span class="id" title="constructor">InjL</span></a> <span class="id" title="var">_</span>) || <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.InjR"><span class="id" title="constructor">InjR</span></a> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_pair" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Pair"><span class="id" title="constructor">Pair</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_closure" := <span class="id" title="var">wp_pure</span> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Rec"><span class="id" title="constructor">Rec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_bind" class="idref" href="#tac_wp_bind"><span class="id" title="lemma">tac_wp_bind</span></a> `{<a id="heapG0:57" class="idref" href="#heapG0:57"><span class="id" title="binder">!</span></a><a id="heapG0:57" class="idref" href="#heapG0:57"><span class="id" title="binder">heapG</span></a> <a id="heapG0:57" class="idref" href="#heapG0:57"><span class="id" title="binder">Σ</span></a>} <a id="K:58" class="idref" href="#K:58"><span class="id" title="binder">K</span></a> <a id="a34401480b9ee68b7620454cfaad3bdd" class="idref" href="#a34401480b9ee68b7620454cfaad3bdd"><span class="id" title="binder">Δ</span></a> <a id="s:60" class="idref" href="#s:60"><span class="id" title="binder">s</span></a> <a id="E:61" class="idref" href="#E:61"><span class="id" title="binder">E</span></a> <a id="071e8b4be4ab41d34ad0a9516fe03a12" class="idref" href="#071e8b4be4ab41d34ad0a9516fe03a12"><span class="id" title="binder">Φ</span></a> <a id="e:63" class="idref" href="#e:63"><span class="id" title="binder">e</span></a> <a id="f:64" class="idref" href="#f:64"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#f:64"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="e:66" class="idref" href="#e:66"><span class="id" title="binder">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:58"><span class="id" title="variable">K</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:66"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;as&nbsp;an&nbsp;eta&nbsp;expanded&nbsp;hypothesis&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;`simpl`&nbsp;it&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#a34401480b9ee68b7620454cfaad3bdd"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">WP</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:63"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:60"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:61"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">{{</span></a> <a id="v:65" class="idref" href="#v:65"><span class="id" title="binder">v</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f:64"><span class="id" title="variable">f</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:65"><span class="id" title="variable">v</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:60"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:61"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#071e8b4be4ab41d34ad0a9516fe03a12"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#eee60bb71eb20943eabf98b71ebd06b9"><span class="id" title="notation">}}</span></a>)%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#a34401480b9ee68b7620454cfaad3bdd"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:58"><span class="id" title="variable">K</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:63"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:60"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:61"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#071e8b4be4ab41d34ad0a9516fe03a12"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; -&gt; -&gt;. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_bind" class="idref" href="#tac_twp_bind"><span class="id" title="lemma">tac_twp_bind</span></a> `{<a id="heapG0:68" class="idref" href="#heapG0:68"><span class="id" title="binder">!</span></a><a id="heapG0:68" class="idref" href="#heapG0:68"><span class="id" title="binder">heapG</span></a> <a id="heapG0:68" class="idref" href="#heapG0:68"><span class="id" title="binder">Σ</span></a>} <a id="K:69" class="idref" href="#K:69"><span class="id" title="binder">K</span></a> <a id="8f968192e18ee121db66203c0893cd62" class="idref" href="#8f968192e18ee121db66203c0893cd62"><span class="id" title="binder">Δ</span></a> <a id="s:71" class="idref" href="#s:71"><span class="id" title="binder">s</span></a> <a id="E:72" class="idref" href="#E:72"><span class="id" title="binder">E</span></a> <a id="008858fd693db6f5aa77f1f7c6d2fd58" class="idref" href="#008858fd693db6f5aa77f1f7c6d2fd58"><span class="id" title="binder">Φ</span></a> <a id="e:74" class="idref" href="#e:74"><span class="id" title="binder">e</span></a> <a id="f:75" class="idref" href="#f:75"><span class="id" title="binder">f</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#f:75"><span class="id" title="variable">f</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="e:77" class="idref" href="#e:77"><span class="id" title="binder">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:69"><span class="id" title="variable">K</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:77"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;as&nbsp;an&nbsp;eta&nbsp;expanded&nbsp;hypothesis&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;`simpl`&nbsp;it&nbsp;*)</span><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#8f968192e18ee121db66203c0893cd62"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">WP</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:74"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:71"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:72"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">[{</span></a> <a id="v:76" class="idref" href="#v:76"><span class="id" title="binder">v</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">,</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f:75"><span class="id" title="variable">f</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:76"><span class="id" title="variable">v</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:71"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:72"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#008858fd693db6f5aa77f1f7c6d2fd58"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#0197e84fdb0a191e588749e927e5eb27"><span class="id" title="notation">}]</span></a>)%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#8f968192e18ee121db66203c0893cd62"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:69"><span class="id" title="variable">K</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e:74"><span class="id" title="variable">e</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:71"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:72"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#008858fd693db6f5aa77f1f7c6d2fd58"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; -&gt; -&gt;. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span>: <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">wp_bind_core</span> <span class="id" title="var">K</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">K</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_bind"><span class="id" title="lemma">tac_wp_bind</span></a> <span class="id" title="var">K</span>); [<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">reflexivity</span>|<span class="id" title="var">reduction.pm_prettify</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">twp_bind_core</span> <span class="id" title="var">K</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="tactic">eval</span> <span class="id" title="tactic">hnf</span> <span class="id" title="tactic">in</span> <span class="id" title="var">K</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_bind"><span class="id" title="lemma">tac_twp_bind</span></a> <span class="id" title="var">K</span>); [<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">reflexivity</span>|<span class="id" title="var">reduction.pm_prettify</span>]<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_bind" <span class="id" title="var">open_constr</span>(<span class="id" title="var">efoc</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">iStartProof</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="var">unify</span> <span class="id" title="var">e'</span> <span class="id" title="var">efoc</span>; <span class="id" title="var">wp_bind_core</span> <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">fail</span> "wp_bind: cannot find" <span class="id" title="var">efoc</span> "in" <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="var">unify</span> <span class="id" title="var">e'</span> <span class="id" title="var">efoc</span>; <span class="id" title="var">twp_bind_core</span> <span class="id" title="var">K</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" title="tactic">fail</span> "wp_bind: cannot find" <span class="id" title="var">efoc</span> "in" <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_bind: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Heap tactics 
</div>
<div class="code">
<span class="id" title="keyword">Section</span> <a id="heap" class="idref" href="#heap"><span class="id" title="section">heap</span></a>.<br/>
<span class="id" title="keyword">Context</span> `{<a id="heapG0:79" class="idref" href="#heapG0:79"><span class="id" title="binder">!</span></a><a id="heapG0:79" class="idref" href="#heapG0:79"><span class="id" title="binder">heapG</span></a> <a id="heapG0:79" class="idref" href="#heapG0:79"><span class="id" title="binder">Σ</span></a>}.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.lib.iprop.html#iProp_solution.iProp"><span class="id" title="abbreviation">iProp</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#c075f1221d2d857b95ac7ce005336844"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Φ</span> : <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.lib.iprop.html#iProp_solution.iProp"><span class="id" title="abbreviation">iProp</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#c075f1221d2d857b95ac7ce005336844"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">Δ</span> : <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs"><span class="id" title="record">envs</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.bi.html#uPredI"><span class="id" title="definition">uPredI</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.base_logic.lib.iprop.html#iProp_solution.iResUR"><span class="id" title="definition">iResUR</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#c075f1221d2d857b95ac7ce005336844"><span class="id" title="variable">Σ</span></a>)).<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.val"><span class="id" title="inductive">val</span></a>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">z</span> : <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_alloc" class="idref" href="#tac_wp_alloc"><span class="id" title="lemma">tac_wp_alloc</span></a> <a id="b23b8783ae23f38cc03ba07a68baceae" class="idref" href="#b23b8783ae23f38cc03ba07a68baceae"><span class="id" title="binder">Δ</span></a> <a id="8bbbde7be59138f706ddc924b820375c" class="idref" href="#8bbbde7be59138f706ddc924b820375c"><span class="id" title="binder">Δ'</span></a> <a id="s:82" class="idref" href="#s:82"><span class="id" title="binder">s</span></a> <a id="E:83" class="idref" href="#E:83"><span class="id" title="binder">E</span></a> <a id="j:84" class="idref" href="#j:84"><span class="id" title="binder">j</span></a> <a id="K:85" class="idref" href="#K:85"><span class="id" title="binder">K</span></a> <a id="v:86" class="idref" href="#v:86"><span class="id" title="binder">v</span></a> <a id="5997d933f28fe25f73d33afa73998d7b" class="idref" href="#5997d933f28fe25f73d33afa73998d7b"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="intensional.heap_lang.proofmode.html#b23b8783ae23f38cc03ba07a68baceae"><span class="id" title="variable">Δ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#8bbbde7be59138f706ddc924b820375c"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="l:88" class="idref" href="#l:88"><span class="id" title="binder">l</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_app"><span class="id" title="definition">envs_app</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#j:84"><span class="id" title="variable">j</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:88"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:86"><span class="id" title="variable">v</span></a>)) <a class="idref" href="intensional.heap_lang.proofmode.html#8bbbde7be59138f706ddc924b820375c"><span class="id" title="variable">Δ'</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ''</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ''</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:85"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:88"><span class="id" title="variable">l</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:82"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:83"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#5997d933f28fe25f73d33afa73998d7b"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#b23b8783ae23f38cc03ba07a68baceae"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:85"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.notation.html#Alloc"><span class="id" title="abbreviation">Alloc</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:86"><span class="id" title="variable">v</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:82"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:83"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#5997d933f28fe25f73d33afa73998d7b"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ? <span class="id" title="var">HΔ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="intensional.heap_lang.lifting.html#wp_alloc"><span class="id" title="lemma">wp_alloc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#left_id"><span class="id" title="definition">left_id</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a>; <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.forall_intro"><span class="id" title="lemma">forall_intro</span></a>=&gt; <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HΔ</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_app"><span class="id" title="definition">envs_app</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ'</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_app_sound"><span class="id" title="lemma">envs_app_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_intro_l"><span class="id" title="lemma">wand_intro_l</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_elim_l"><span class="id" title="lemma">sep_elim_l</span></a> (<span class="id" title="var">l</span> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <span class="id" title="var">v</span>)%<span class="id" title="var">I</span>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_elim_r"><span class="id" title="lemma">wand_elim_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_alloc" class="idref" href="#tac_twp_alloc"><span class="id" title="lemma">tac_twp_alloc</span></a> <a id="88fb8fe41602825f8f1b9ac2003b3abc" class="idref" href="#88fb8fe41602825f8f1b9ac2003b3abc"><span class="id" title="binder">Δ</span></a> <a id="s:90" class="idref" href="#s:90"><span class="id" title="binder">s</span></a> <a id="E:91" class="idref" href="#E:91"><span class="id" title="binder">E</span></a> <a id="j:92" class="idref" href="#j:92"><span class="id" title="binder">j</span></a> <a id="K:93" class="idref" href="#K:93"><span class="id" title="binder">K</span></a> <a id="v:94" class="idref" href="#v:94"><span class="id" title="binder">v</span></a> <a id="5bbf64382814d0c44a11a33e7dd499e5" class="idref" href="#5bbf64382814d0c44a11a33e7dd499e5"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="l:96" class="idref" href="#l:96"><span class="id" title="binder">l</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_app"><span class="id" title="definition">envs_app</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#j:92"><span class="id" title="variable">j</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:96"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:94"><span class="id" title="variable">v</span></a>)) <a class="idref" href="intensional.heap_lang.proofmode.html#88fb8fe41602825f8f1b9ac2003b3abc"><span class="id" title="variable">Δ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ'</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:93"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitLoc"><span class="id" title="constructor">LitLoc</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:96"><span class="id" title="variable">l</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:90"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:91"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#5bbf64382814d0c44a11a33e7dd499e5"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#88fb8fe41602825f8f1b9ac2003b3abc"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:93"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.notation.html#Alloc"><span class="id" title="abbreviation">Alloc</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:94"><span class="id" title="variable">v</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:90"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:91"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#5bbf64382814d0c44a11a33e7dd499e5"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; <span class="id" title="var">HΔ</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="intensional.heap_lang.lifting.html#twp_alloc"><span class="id" title="lemma">twp_alloc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#left_id"><span class="id" title="definition">left_id</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.forall_intro"><span class="id" title="lemma">forall_intro</span></a>=&gt; <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">HΔ</span> <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_app"><span class="id" title="definition">envs_app</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ'</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_app_sound"><span class="id" title="lemma">envs_app_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_intro_l"><span class="id" title="lemma">wand_intro_l</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_elim_l"><span class="id" title="lemma">sep_elim_l</span></a> (<span class="id" title="var">l</span> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <span class="id" title="var">v</span>)%<span class="id" title="var">I</span>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_elim_r"><span class="id" title="lemma">wand_elim_r</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_load" class="idref" href="#tac_wp_load"><span class="id" title="lemma">tac_wp_load</span></a> <a id="74bd379b0166d4d087baacf1d44b04c9" class="idref" href="#74bd379b0166d4d087baacf1d44b04c9"><span class="id" title="binder">Δ</span></a> <a id="b096360705c3c227696ece706fab026c" class="idref" href="#b096360705c3c227696ece706fab026c"><span class="id" title="binder">Δ'</span></a> <a id="s:99" class="idref" href="#s:99"><span class="id" title="binder">s</span></a> <a id="E:100" class="idref" href="#E:100"><span class="id" title="binder">E</span></a> <a id="i:101" class="idref" href="#i:101"><span class="id" title="binder">i</span></a> <a id="K:102" class="idref" href="#K:102"><span class="id" title="binder">K</span></a> <a id="l:103" class="idref" href="#l:103"><span class="id" title="binder">l</span></a> <a id="q:104" class="idref" href="#q:104"><span class="id" title="binder">q</span></a> <a id="v:105" class="idref" href="#v:105"><span class="id" title="binder">v</span></a> <a id="827a2d2883ed87a6c547d53b7a03b5e5" class="idref" href="#827a2d2883ed87a6c547d53b7a03b5e5"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="intensional.heap_lang.proofmode.html#74bd379b0166d4d087baacf1d44b04c9"><span class="id" title="variable">Δ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#b096360705c3c227696ece706fab026c"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:101"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#b096360705c3c227696ece706fab026c"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:103"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><a class="idref" href="intensional.heap_lang.proofmode.html#q:104"><span class="id" title="variable">q</span></a><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:105"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#b096360705c3c227696ece706fab026c"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:102"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:105"><span class="id" title="variable">v</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:99"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:100"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#827a2d2883ed87a6c547d53b7a03b5e5"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#74bd379b0166d4d087baacf1d44b04c9"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:102"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Load"><span class="id" title="constructor">Load</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:103"><span class="id" title="variable">l</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:99"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:100"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#827a2d2883ed87a6c547d53b7a03b5e5"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ???.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="intensional.heap_lang.lifting.html#wp_load"><span class="id" title="lemma">wp_load</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws_later.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_load" class="idref" href="#tac_twp_load"><span class="id" title="lemma">tac_twp_load</span></a> <a id="4be74ba61845d5afc1ddd33b3d7f9ba3" class="idref" href="#4be74ba61845d5afc1ddd33b3d7f9ba3"><span class="id" title="binder">Δ</span></a> <a id="s:108" class="idref" href="#s:108"><span class="id" title="binder">s</span></a> <a id="E:109" class="idref" href="#E:109"><span class="id" title="binder">E</span></a> <a id="i:110" class="idref" href="#i:110"><span class="id" title="binder">i</span></a> <a id="K:111" class="idref" href="#K:111"><span class="id" title="binder">K</span></a> <a id="l:112" class="idref" href="#l:112"><span class="id" title="binder">l</span></a> <a id="q:113" class="idref" href="#q:113"><span class="id" title="binder">q</span></a> <a id="v:114" class="idref" href="#v:114"><span class="id" title="binder">v</span></a> <a id="bcfd84fbe06e9c7094cfb59bee848aff" class="idref" href="#bcfd84fbe06e9c7094cfb59bee848aff"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:110"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#4be74ba61845d5afc1ddd33b3d7f9ba3"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:112"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><a class="idref" href="intensional.heap_lang.proofmode.html#q:113"><span class="id" title="variable">q</span></a><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:114"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#4be74ba61845d5afc1ddd33b3d7f9ba3"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:111"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:114"><span class="id" title="variable">v</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:108"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:109"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#bcfd84fbe06e9c7094cfb59bee848aff"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#4be74ba61845d5afc1ddd33b3d7f9ba3"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:111"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Load"><span class="id" title="constructor">Load</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:112"><span class="id" title="variable">l</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:108"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:109"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#bcfd84fbe06e9c7094cfb59bee848aff"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ??.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="intensional.heap_lang.lifting.html#twp_load"><span class="id" title="lemma">twp_load</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_store" class="idref" href="#tac_wp_store"><span class="id" title="lemma">tac_wp_store</span></a> <a id="5de2cbc586e4c05bbc583847532b590b" class="idref" href="#5de2cbc586e4c05bbc583847532b590b"><span class="id" title="binder">Δ</span></a> <a id="f44cc30001e05f41e451ae9a8a6ee5db" class="idref" href="#f44cc30001e05f41e451ae9a8a6ee5db"><span class="id" title="binder">Δ'</span></a> <a id="s:118" class="idref" href="#s:118"><span class="id" title="binder">s</span></a> <a id="E:119" class="idref" href="#E:119"><span class="id" title="binder">E</span></a> <a id="i:120" class="idref" href="#i:120"><span class="id" title="binder">i</span></a> <a id="K:121" class="idref" href="#K:121"><span class="id" title="binder">K</span></a> <a id="l:122" class="idref" href="#l:122"><span class="id" title="binder">l</span></a> <a id="v:123" class="idref" href="#v:123"><span class="id" title="binder">v</span></a> <a id="v':124" class="idref" href="#v':124"><span class="id" title="binder">v'</span></a> <a id="6cb425a9d593a0283b54128c368b4d51" class="idref" href="#6cb425a9d593a0283b54128c368b4d51"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="intensional.heap_lang.proofmode.html#5de2cbc586e4c05bbc583847532b590b"><span class="id" title="variable">Δ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f44cc30001e05f41e451ae9a8a6ee5db"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:120"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#f44cc30001e05f41e451ae9a8a6ee5db"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:122"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:123"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:120"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:120"><span class="id" title="variable">i</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:122"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v':124"><span class="id" title="variable">v'</span></a>)) <a class="idref" href="intensional.heap_lang.proofmode.html#f44cc30001e05f41e451ae9a8a6ee5db"><span class="id" title="variable">Δ'</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ''</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ''</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:121"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitUnit"><span class="id" title="constructor">LitUnit</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:118"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:119"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#6cb425a9d593a0283b54128c368b4d51"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#5de2cbc586e4c05bbc583847532b590b"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:121"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Store"><span class="id" title="constructor">Store</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:122"><span class="id" title="variable">l</span></a>) (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v':124"><span class="id" title="variable">v'</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:118"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:119"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#6cb425a9d593a0283b54128c368b4d51"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ???.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ''</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.lifting.html#wp_store"><span class="id" title="lemma">wp_store</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws_later.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_store" class="idref" href="#tac_twp_store"><span class="id" title="lemma">tac_twp_store</span></a> <a id="ad60e307443b7d2e474f1a436ce2610b" class="idref" href="#ad60e307443b7d2e474f1a436ce2610b"><span class="id" title="binder">Δ</span></a> <a id="s:127" class="idref" href="#s:127"><span class="id" title="binder">s</span></a> <a id="E:128" class="idref" href="#E:128"><span class="id" title="binder">E</span></a> <a id="i:129" class="idref" href="#i:129"><span class="id" title="binder">i</span></a> <a id="K:130" class="idref" href="#K:130"><span class="id" title="binder">K</span></a> <a id="l:131" class="idref" href="#l:131"><span class="id" title="binder">l</span></a> <a id="v:132" class="idref" href="#v:132"><span class="id" title="binder">v</span></a> <a id="v':133" class="idref" href="#v':133"><span class="id" title="binder">v'</span></a> <a id="0d57e2010aeaba739dd4ed989aaef8cd" class="idref" href="#0d57e2010aeaba739dd4ed989aaef8cd"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:129"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#ad60e307443b7d2e474f1a436ce2610b"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:131"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:132"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:129"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:129"><span class="id" title="variable">i</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:131"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v':133"><span class="id" title="variable">v'</span></a>)) <a class="idref" href="intensional.heap_lang.proofmode.html#ad60e307443b7d2e474f1a436ce2610b"><span class="id" title="variable">Δ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ'</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ'</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:130"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitUnit"><span class="id" title="constructor">LitUnit</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:127"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:128"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#0d57e2010aeaba739dd4ed989aaef8cd"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#ad60e307443b7d2e474f1a436ce2610b"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:130"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Store"><span class="id" title="constructor">Store</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:131"><span class="id" title="variable">l</span></a>) <a class="idref" href="intensional.heap_lang.proofmode.html#v':133"><span class="id" title="variable">v'</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:127"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:128"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#0d57e2010aeaba739dd4ed989aaef8cd"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ''</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.lifting.html#twp_store"><span class="id" title="lemma">twp_store</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_cmpxchg" class="idref" href="#tac_wp_cmpxchg"><span class="id" title="lemma">tac_wp_cmpxchg</span></a> <a id="98fbe40c8c0cdcc6c557ee9493a7a4f3" class="idref" href="#98fbe40c8c0cdcc6c557ee9493a7a4f3"><span class="id" title="binder">Δ</span></a> <a id="51f652e024da880785253c728cf7a40b" class="idref" href="#51f652e024da880785253c728cf7a40b"><span class="id" title="binder">Δ'</span></a> <a id="s:137" class="idref" href="#s:137"><span class="id" title="binder">s</span></a> <a id="E:138" class="idref" href="#E:138"><span class="id" title="binder">E</span></a> <a id="i:139" class="idref" href="#i:139"><span class="id" title="binder">i</span></a> <a id="K:140" class="idref" href="#K:140"><span class="id" title="binder">K</span></a> <a id="l:141" class="idref" href="#l:141"><span class="id" title="binder">l</span></a> <a id="v:142" class="idref" href="#v:142"><span class="id" title="binder">v</span></a> <a id="v1:143" class="idref" href="#v1:143"><span class="id" title="binder">v1</span></a> <a id="v2:144" class="idref" href="#v2:144"><span class="id" title="binder">v2</span></a> <a id="3aea9fbf73c9d6bc5ea85dc47e62e550" class="idref" href="#3aea9fbf73c9d6bc5ea85dc47e62e550"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="intensional.heap_lang.proofmode.html#98fbe40c8c0cdcc6c557ee9493a7a4f3"><span class="id" title="variable">Δ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#51f652e024da880785253c728cf7a40b"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:139"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#51f652e024da880785253c728cf7a40b"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:141"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:142"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:142"><span class="id" title="variable">v</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:143"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:139"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:139"><span class="id" title="variable">i</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:141"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:144"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="intensional.heap_lang.proofmode.html#51f652e024da880785253c728cf7a40b"><span class="id" title="variable">Δ'</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ''</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#v:142"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:143"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ''</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:140"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:142"><span class="id" title="variable">v</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:137"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:138"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#3aea9fbf73c9d6bc5ea85dc47e62e550"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="intensional.heap_lang.proofmode.html#v:142"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:143"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#51f652e024da880785253c728cf7a40b"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:140"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:142"><span class="id" title="variable">v</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:137"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:138"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#3aea9fbf73c9d6bc5ea85dc47e62e550"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#98fbe40c8c0cdcc6c557ee9493a7a4f3"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:140"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:141"><span class="id" title="variable">l</span></a>) (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:143"><span class="id" title="variable">v1</span></a>) (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:144"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:137"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:138"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#3aea9fbf73c9d6bc5ea85dc47e62e550"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ??? <span class="id" title="var">Hsuc</span> <span class="id" title="var">Hfail</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ''</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#decide"><span class="id" title="definition">decide</span></a> (<span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v1</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hne</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.lifting.html#wp_cmpxchg_suc"><span class="id" title="lemma">wp_cmpxchg_suc</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws_later.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> /= {1}<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.lifting.html#wp_cmpxchg_fail"><span class="id" title="lemma">wp_cmpxchg_fail</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws_later.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> /= {1}<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_cmpxchg" class="idref" href="#tac_twp_cmpxchg"><span class="id" title="lemma">tac_twp_cmpxchg</span></a> <a id="9aa1b8f92d89dfa875946aba8367f6fe" class="idref" href="#9aa1b8f92d89dfa875946aba8367f6fe"><span class="id" title="binder">Δ</span></a> <a id="s:147" class="idref" href="#s:147"><span class="id" title="binder">s</span></a> <a id="E:148" class="idref" href="#E:148"><span class="id" title="binder">E</span></a> <a id="i:149" class="idref" href="#i:149"><span class="id" title="binder">i</span></a> <a id="K:150" class="idref" href="#K:150"><span class="id" title="binder">K</span></a> <a id="l:151" class="idref" href="#l:151"><span class="id" title="binder">l</span></a> <a id="v:152" class="idref" href="#v:152"><span class="id" title="binder">v</span></a> <a id="v1:153" class="idref" href="#v1:153"><span class="id" title="binder">v1</span></a> <a id="v2:154" class="idref" href="#v2:154"><span class="id" title="binder">v2</span></a> <a id="d98df6bf97aefd031e0bcb702e074ec4" class="idref" href="#d98df6bf97aefd031e0bcb702e074ec4"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:149"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#9aa1b8f92d89dfa875946aba8367f6fe"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:152"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:152"><span class="id" title="variable">v</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:153"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:149"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:149"><span class="id" title="variable">i</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:151"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:154"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="intensional.heap_lang.proofmode.html#9aa1b8f92d89dfa875946aba8367f6fe"><span class="id" title="variable">Δ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#v:152"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:153"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ'</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:150"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:152"><span class="id" title="variable">v</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:147"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:148"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#d98df6bf97aefd031e0bcb702e074ec4"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="intensional.heap_lang.proofmode.html#v:152"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:153"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#9aa1b8f92d89dfa875946aba8367f6fe"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:150"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:152"><span class="id" title="variable">v</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:147"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:148"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#d98df6bf97aefd031e0bcb702e074ec4"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#9aa1b8f92d89dfa875946aba8367f6fe"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:150"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:151"><span class="id" title="variable">l</span></a>) <a class="idref" href="intensional.heap_lang.proofmode.html#v1:153"><span class="id" title="variable">v1</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:154"><span class="id" title="variable">v2</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:147"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:148"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#d98df6bf97aefd031e0bcb702e074ec4"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ?? <span class="id" title="var">Hsuc</span> <span class="id" title="var">Hfail</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ''</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#decide"><span class="id" title="definition">decide</span></a> (<span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">v1</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq</span>|<span class="id" title="var">Hne</span>].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.lifting.html#twp_cmpxchg_suc"><span class="id" title="lemma">twp_cmpxchg_suc</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /= {1}<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.lifting.html#twp_cmpxchg_fail"><span class="id" title="lemma">twp_cmpxchg_fail</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /= {1}<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_cmpxchg_fail" class="idref" href="#tac_wp_cmpxchg_fail"><span class="id" title="lemma">tac_wp_cmpxchg_fail</span></a> <a id="7116d950bfe3eb986a27e9c57db70a5e" class="idref" href="#7116d950bfe3eb986a27e9c57db70a5e"><span class="id" title="binder">Δ</span></a> <a id="1575e50b105aa74aa7a2cd119280d4b8" class="idref" href="#1575e50b105aa74aa7a2cd119280d4b8"><span class="id" title="binder">Δ'</span></a> <a id="s:158" class="idref" href="#s:158"><span class="id" title="binder">s</span></a> <a id="E:159" class="idref" href="#E:159"><span class="id" title="binder">E</span></a> <a id="i:160" class="idref" href="#i:160"><span class="id" title="binder">i</span></a> <a id="K:161" class="idref" href="#K:161"><span class="id" title="binder">K</span></a> <a id="l:162" class="idref" href="#l:162"><span class="id" title="binder">l</span></a> <a id="q:163" class="idref" href="#q:163"><span class="id" title="binder">q</span></a> <a id="v:164" class="idref" href="#v:164"><span class="id" title="binder">v</span></a> <a id="v1:165" class="idref" href="#v1:165"><span class="id" title="binder">v1</span></a> <a id="v2:166" class="idref" href="#v2:166"><span class="id" title="binder">v2</span></a> <a id="8d2354b8dc20d9ba67d312f111bc8012" class="idref" href="#8d2354b8dc20d9ba67d312f111bc8012"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="intensional.heap_lang.proofmode.html#7116d950bfe3eb986a27e9c57db70a5e"><span class="id" title="variable">Δ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#1575e50b105aa74aa7a2cd119280d4b8"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:160"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#1575e50b105aa74aa7a2cd119280d4b8"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:162"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><a class="idref" href="intensional.heap_lang.proofmode.html#q:163"><span class="id" title="variable">q</span></a><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:164"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#v:164"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:165"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:164"><span class="id" title="variable">v</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:165"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#1575e50b105aa74aa7a2cd119280d4b8"><span class="id" title="variable">Δ'</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:161"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:164"><span class="id" title="variable">v</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:158"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:159"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#8d2354b8dc20d9ba67d312f111bc8012"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#7116d950bfe3eb986a27e9c57db70a5e"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:161"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:162"><span class="id" title="variable">l</span></a>) <a class="idref" href="intensional.heap_lang.proofmode.html#v1:165"><span class="id" title="variable">v1</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:166"><span class="id" title="variable">v2</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:158"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:159"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#8d2354b8dc20d9ba67d312f111bc8012"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ?????.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="intensional.heap_lang.lifting.html#wp_cmpxchg_fail"><span class="id" title="lemma">wp_cmpxchg_fail</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws_later.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_cmpxchg_fail" class="idref" href="#tac_twp_cmpxchg_fail"><span class="id" title="lemma">tac_twp_cmpxchg_fail</span></a> <a id="298d15191315d12fd2f332d52f62104c" class="idref" href="#298d15191315d12fd2f332d52f62104c"><span class="id" title="binder">Δ</span></a> <a id="s:169" class="idref" href="#s:169"><span class="id" title="binder">s</span></a> <a id="E:170" class="idref" href="#E:170"><span class="id" title="binder">E</span></a> <a id="i:171" class="idref" href="#i:171"><span class="id" title="binder">i</span></a> <a id="K:172" class="idref" href="#K:172"><span class="id" title="binder">K</span></a> <a id="l:173" class="idref" href="#l:173"><span class="id" title="binder">l</span></a> <a id="q:174" class="idref" href="#q:174"><span class="id" title="binder">q</span></a> <a id="v:175" class="idref" href="#v:175"><span class="id" title="binder">v</span></a> <a id="v1:176" class="idref" href="#v1:176"><span class="id" title="binder">v1</span></a> <a id="v2:177" class="idref" href="#v2:177"><span class="id" title="binder">v2</span></a> <a id="86bbb5584eefe1ec1174f6e7d0ce6af4" class="idref" href="#86bbb5584eefe1ec1174f6e7d0ce6af4"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:171"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#298d15191315d12fd2f332d52f62104c"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:173"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><a class="idref" href="intensional.heap_lang.proofmode.html#q:174"><span class="id" title="variable">q</span></a><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:175"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#v:175"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:176"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:175"><span class="id" title="variable">v</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:176"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#298d15191315d12fd2f332d52f62104c"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:172"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:175"><span class="id" title="variable">v</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:169"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:170"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#86bbb5584eefe1ec1174f6e7d0ce6af4"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#298d15191315d12fd2f332d52f62104c"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:172"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:173"><span class="id" title="variable">l</span></a>) <a class="idref" href="intensional.heap_lang.proofmode.html#v1:176"><span class="id" title="variable">v1</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:177"><span class="id" title="variable">v2</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:169"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:170"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#86bbb5584eefe1ec1174f6e7d0ce6af4"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: <a class="idref" href="intensional.heap_lang.lifting.html#twp_cmpxchg_fail"><span class="id" title="lemma">twp_cmpxchg_fail</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup_split"><span class="id" title="lemma">envs_lookup_split</span></a> //=. <span class="id" title="tactic">by</span> <span class="id" title="tactic">do</span> 2 <span class="id" title="var">f_equiv</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_cmpxchg_suc" class="idref" href="#tac_wp_cmpxchg_suc"><span class="id" title="lemma">tac_wp_cmpxchg_suc</span></a> <a id="a5864ddeb9f164c613bec934bdcd6f16" class="idref" href="#a5864ddeb9f164c613bec934bdcd6f16"><span class="id" title="binder">Δ</span></a> <a id="07cb7310faac5dbfac38c52f540dbc21" class="idref" href="#07cb7310faac5dbfac38c52f540dbc21"><span class="id" title="binder">Δ'</span></a> <a id="s:181" class="idref" href="#s:181"><span class="id" title="binder">s</span></a> <a id="E:182" class="idref" href="#E:182"><span class="id" title="binder">E</span></a> <a id="i:183" class="idref" href="#i:183"><span class="id" title="binder">i</span></a> <a id="K:184" class="idref" href="#K:184"><span class="id" title="binder">K</span></a> <a id="l:185" class="idref" href="#l:185"><span class="id" title="binder">l</span></a> <a id="v:186" class="idref" href="#v:186"><span class="id" title="binder">v</span></a> <a id="v1:187" class="idref" href="#v1:187"><span class="id" title="binder">v1</span></a> <a id="v2:188" class="idref" href="#v2:188"><span class="id" title="binder">v2</span></a> <a id="7bfafac7dfe23de2dbb1360973b70c51" class="idref" href="#7bfafac7dfe23de2dbb1360973b70c51"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="intensional.heap_lang.proofmode.html#a5864ddeb9f164c613bec934bdcd6f16"><span class="id" title="variable">Δ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#07cb7310faac5dbfac38c52f540dbc21"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:183"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#07cb7310faac5dbfac38c52f540dbc21"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:185"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:186"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#v:186"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:187"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:186"><span class="id" title="variable">v</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:187"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:183"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:183"><span class="id" title="variable">i</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:185"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:188"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="intensional.heap_lang.proofmode.html#07cb7310faac5dbfac38c52f540dbc21"><span class="id" title="variable">Δ'</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ''</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ''</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:184"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:186"><span class="id" title="variable">v</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:181"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:182"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#7bfafac7dfe23de2dbb1360973b70c51"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#a5864ddeb9f164c613bec934bdcd6f16"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:184"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:185"><span class="id" title="variable">l</span></a>) <a class="idref" href="intensional.heap_lang.proofmode.html#v1:187"><span class="id" title="variable">v1</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:188"><span class="id" title="variable">v2</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:181"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:182"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#7bfafac7dfe23de2dbb1360973b70c51"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ?????; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ''</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.lifting.html#wp_cmpxchg_suc"><span class="id" title="lemma">wp_cmpxchg_suc</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws_later.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_cmpxchg_suc" class="idref" href="#tac_twp_cmpxchg_suc"><span class="id" title="lemma">tac_twp_cmpxchg_suc</span></a> <a id="e3f559247b9dea8ed2e53daed84a0270" class="idref" href="#e3f559247b9dea8ed2e53daed84a0270"><span class="id" title="binder">Δ</span></a> <a id="s:191" class="idref" href="#s:191"><span class="id" title="binder">s</span></a> <a id="E:192" class="idref" href="#E:192"><span class="id" title="binder">E</span></a> <a id="i:193" class="idref" href="#i:193"><span class="id" title="binder">i</span></a> <a id="K:194" class="idref" href="#K:194"><span class="id" title="binder">K</span></a> <a id="l:195" class="idref" href="#l:195"><span class="id" title="binder">l</span></a> <a id="v:196" class="idref" href="#v:196"><span class="id" title="binder">v</span></a> <a id="v1:197" class="idref" href="#v1:197"><span class="id" title="binder">v1</span></a> <a id="v2:198" class="idref" href="#v2:198"><span class="id" title="binder">v2</span></a> <a id="2c4b5d0a9b26cd26d2dc2824755febd3" class="idref" href="#2c4b5d0a9b26cd26d2dc2824755febd3"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:193"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e3f559247b9dea8ed2e53daed84a0270"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:195"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:196"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="intensional.heap_lang.proofmode.html#v:196"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:197"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.vals_compare_safe"><span class="id" title="definition">vals_compare_safe</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:196"><span class="id" title="variable">v</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v1:197"><span class="id" title="variable">v1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:193"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:193"><span class="id" title="variable">i</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:195"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:198"><span class="id" title="variable">v2</span></a>)) <a class="idref" href="intensional.heap_lang.proofmode.html#e3f559247b9dea8ed2e53daed84a0270"><span class="id" title="variable">Δ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ'</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:194"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.PairV"><span class="id" title="constructor">PairV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v:196"><span class="id" title="variable">v</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitBool"><span class="id" title="constructor">LitBool</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:191"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:192"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#2c4b5d0a9b26cd26d2dc2824755febd3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#e3f559247b9dea8ed2e53daed84a0270"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:194"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.CmpXchg"><span class="id" title="constructor">CmpXchg</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:195"><span class="id" title="variable">l</span></a>) <a class="idref" href="intensional.heap_lang.proofmode.html#v1:197"><span class="id" title="variable">v1</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#v2:198"><span class="id" title="variable">v2</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:191"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:192"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#2c4b5d0a9b26cd26d2dc2824755febd3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt;????; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ''</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="intensional.heap_lang.lifting.html#twp_cmpxchg_suc"><span class="id" title="lemma">twp_cmpxchg_suc</span></a>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_wp_faa" class="idref" href="#tac_wp_faa"><span class="id" title="lemma">tac_wp_faa</span></a> <a id="3405cf8e408305b2d6f3415e2162f387" class="idref" href="#3405cf8e408305b2d6f3415e2162f387"><span class="id" title="binder">Δ</span></a> <a id="dcea08d2bd901d5bde7b67d190e7a9fb" class="idref" href="#dcea08d2bd901d5bde7b67d190e7a9fb"><span class="id" title="binder">Δ'</span></a> <a id="s:202" class="idref" href="#s:202"><span class="id" title="binder">s</span></a> <a id="E:203" class="idref" href="#E:203"><span class="id" title="binder">E</span></a> <a id="i:204" class="idref" href="#i:204"><span class="id" title="binder">i</span></a> <a id="K:205" class="idref" href="#K:205"><span class="id" title="binder">K</span></a> <a id="l:206" class="idref" href="#l:206"><span class="id" title="binder">l</span></a> <a id="z1:207" class="idref" href="#z1:207"><span class="id" title="binder">z1</span></a> <a id="z2:208" class="idref" href="#z2:208"><span class="id" title="binder">z2</span></a> <a id="bace0018502e2c420757b4fb279e3b80" class="idref" href="#bace0018502e2c420757b4fb279e3b80"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#MaybeIntoLaterNEnvs"><span class="id" title="class">MaybeIntoLaterNEnvs</span></a> 1 <a class="idref" href="intensional.heap_lang.proofmode.html#3405cf8e408305b2d6f3415e2162f387"><span class="id" title="variable">Δ</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#dcea08d2bd901d5bde7b67d190e7a9fb"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:204"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#dcea08d2bd901d5bde7b67d190e7a9fb"><span class="id" title="variable">Δ'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:206"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#z1:207"><span class="id" title="variable">z1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:204"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:204"><span class="id" title="variable">i</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:206"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitInt"><span class="id" title="constructor">LitInt</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#z1:207"><span class="id" title="variable">z1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#z2:208"><span class="id" title="variable">z2</span></a>)))) <a class="idref" href="intensional.heap_lang.proofmode.html#dcea08d2bd901d5bde7b67d190e7a9fb"><span class="id" title="variable">Δ'</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ''</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ''</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:205"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#z1:207"><span class="id" title="variable">z1</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:202"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:203"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#bace0018502e2c420757b4fb279e3b80"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#3405cf8e408305b2d6f3415e2162f387"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:205"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:206"><span class="id" title="variable">l</span></a>) (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#z2:208"><span class="id" title="variable">z2</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:202"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:203"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">{{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#bace0018502e2c420757b4fb279e3b80"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#ca808999e0a0dfd644967e1c18004286"><span class="id" title="notation">}}</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ???.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ''</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ''</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: (<a class="idref" href="intensional.heap_lang.lifting.html#wp_faa"><span class="id" title="lemma">wp_faa</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.coq_tactics.html#into_laterN_env_sound"><span class="id" title="lemma">into_laterN_env_sound</span></a> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws_later.html#bi.later_sep"><span class="id" title="lemma">later_sep</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.interface.html#bi.later_mono"><span class="id" title="lemma">later_mono</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">Lemma</span> <a id="tac_twp_faa" class="idref" href="#tac_twp_faa"><span class="id" title="lemma">tac_twp_faa</span></a> <a id="6cb98e14c3e20fba5a021d65487c7d48" class="idref" href="#6cb98e14c3e20fba5a021d65487c7d48"><span class="id" title="binder">Δ</span></a> <a id="s:211" class="idref" href="#s:211"><span class="id" title="binder">s</span></a> <a id="E:212" class="idref" href="#E:212"><span class="id" title="binder">E</span></a> <a id="i:213" class="idref" href="#i:213"><span class="id" title="binder">i</span></a> <a id="K:214" class="idref" href="#K:214"><span class="id" title="binder">K</span></a> <a id="l:215" class="idref" href="#l:215"><span class="id" title="binder">l</span></a> <a id="z1:216" class="idref" href="#z1:216"><span class="id" title="binder">z1</span></a> <a id="z2:217" class="idref" href="#z2:217"><span class="id" title="binder">z2</span></a> <a id="0a2e320f007bdfac16bd3cf3b18461f3" class="idref" href="#0a2e320f007bdfac16bd3cf3b18461f3"><span class="id" title="binder">Φ</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_lookup"><span class="id" title="definition">envs_lookup</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:213"><span class="id" title="variable">i</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#6cb98e14c3e20fba5a021d65487c7d48"><span class="id" title="variable">Δ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:215"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#z1:216"><span class="id" title="variable">z1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>%<span class="id" title="var">I</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:213"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Esnoc"><span class="id" title="constructor">Esnoc</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#Enil"><span class="id" title="constructor">Enil</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#i:213"><span class="id" title="variable">i</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#l:215"><span class="id" title="variable">l</span></a> <a class="idref" href="intensional.heap_lang.lifting.html#db9bde1508f348dd1f9d24e9d4ead804"><span class="id" title="notation">↦</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitInt"><span class="id" title="constructor">LitInt</span></a> (<a class="idref" href="intensional.heap_lang.proofmode.html#z1:216"><span class="id" title="variable">z1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.ZArith.BinInt.html#46584eddd5fdb16176a10a2843177d3a"><span class="id" title="notation">+</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#z2:217"><span class="id" title="variable">z2</span></a>)))) <a class="idref" href="intensional.heap_lang.proofmode.html#6cb98e14c3e20fba5a021d65487c7d48"><span class="id" title="variable">Δ</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">Δ'</span> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">Δ'</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:214"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.Val"><span class="id" title="constructor">Val</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#547692780023ef044153bc0c4f871ef7"><span class="id" title="notation">$</span></a> <a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#z1:216"><span class="id" title="variable">z1</span></a>) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:211"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:212"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#0a2e320f007bdfac16bd3cf3b18461f3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#6cb98e14c3e20fba5a021d65487c7d48"><span class="id" title="variable">Δ</span></a> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">WP</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.ectxi_language.html#fill"><span class="id" title="definition">fill</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#K:214"><span class="id" title="variable">K</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.FAA"><span class="id" title="constructor">FAA</span></a> (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#l:215"><span class="id" title="variable">l</span></a>) (<a class="idref" href="intensional.heap_lang.lang.html#heap_lang.LitV"><span class="id" title="constructor">LitV</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#z2:217"><span class="id" title="variable">z2</span></a>)) <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">@</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#s:211"><span class="id" title="variable">s</span></a><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">;</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#E:212"><span class="id" title="variable">E</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">[{</span></a> <a class="idref" href="intensional.heap_lang.proofmode.html#0a2e320f007bdfac16bd3cf3b18461f3"><span class="id" title="variable">Φ</span></a> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#fb462fe24301dea560ea156e509d5c48"><span class="id" title="notation">}]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails_eq"><span class="id" title="definition">envs_entails_eq</span></a>=&gt; ??.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace"><span class="id" title="definition">envs_simple_replace</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Δ'</span>|] <span class="id" title="var">eqn</span>:<span class="id" title="var">HΔ'</span>; [ | <span class="id" title="var">contradiction</span> ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.total_weakestpre.html#twp_bind"><span class="id" title="lemma">twp_bind</span></a>. <span class="id" title="tactic">eapply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_apply"><span class="id" title="lemma">wand_apply</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">exact</span>: (<a class="idref" href="intensional.heap_lang.lifting.html#twp_faa"><span class="id" title="lemma">twp_faa</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">z1</span> <span class="id" title="var">z2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_simple_replace_sound"><span class="id" title="lemma">envs_simple_replace_sound</span></a> //; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#right_id"><span class="id" title="definition">right_id</span></a>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.sep_mono_r"><span class="id" title="lemma">sep_mono_r</span></a>, <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.derived_laws.html#bi.wand_mono"><span class="id" title="lemma">wand_mono</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="intensional.heap_lang.proofmode.html#heap"><span class="id" title="section">heap</span></a>.<br/>

<br/>
</div>

<div class="doc">
Evaluate <span class="inlinecode"><span class="id" title="var">lem</span></span> to a hypothesis <span class="inlinecode"><span class="id" title="var">H</span></span> that can be applied, and then run
<span class="inlinecode"><a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_bind"><span class="id" title="lemma">wp_bind</span></a></span> <span class="inlinecode"><span class="id" title="var">K</span>;</span> <span class="inlinecode"><span class="id" title="var">tac</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> for every possible evaluation context.  <span class="inlinecode"><span class="id" title="var">tac</span></span> can do
<span class="inlinecode"><span class="id" title="var">iApplyHyp</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> to actually apply the hypothesis.  TC resolution of <span class="inlinecode"><span class="id" title="var">lem</span></span> premises
happens *after* <span class="inlinecode"><span class="id" title="var">tac</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> got executed. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "wp_apply_core" <span class="id" title="var">open_constr</span>(<span class="id" title="var">lem</span>) <span class="id" title="var">tactic3</span>(<span class="id" title="var">tac</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="var">iPoseProofCore</span> <span class="id" title="var">lem</span> <span class="id" title="keyword">as</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wp_bind_core</span> <span class="id" title="var">K</span>; <span class="id" title="var">tac</span> <span class="id" title="var">H</span>) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">iTypeOf</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>?<span class="id" title="var">P</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="tactic">fail</span> "wp_apply: cannot apply" <span class="id" title="var">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">twp_bind_core</span> <span class="id" title="var">K</span>; <span class="id" title="var">tac</span> <span class="id" title="var">H</span>) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">iTypeOf</span> <span class="id" title="var">H</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a>?<span class="id" title="var">P</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="tactic">fail</span> "wp_apply: cannot apply" <span class="id" title="var">P</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_apply: not a 'wp'"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>).<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_apply" <span class="id" title="var">open_constr</span>(<span class="id" title="var">lem</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_apply_core</span> <span class="id" title="var">lem</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">iApplyHyp</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">iNext</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">wp_expr_simpl</span>).<br/>
</div>

<div class="doc">
Tactic tailored for atomic triples: the first, simple one just runs
<span class="inlinecode"><span class="id" title="var">iAuIntro</span></span> on the goal, as atomic triples always have an atomic update as their
premise.  The second one additionaly does some framing: it gets rid of <span class="inlinecode"><span class="id" title="var">Hs</span></span> from
the context, which is intended to be the non-laterable assertions that iAuIntro
would choke on.  You get them all back in the continuation of the atomic
operation. 
</div>
<div class="code">
<span class="id" title="keyword">Tactic Notation</span> "awp_apply" <span class="id" title="var">open_constr</span>(<span class="id" title="var">lem</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_apply_core</span> <span class="id" title="var">lem</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">iApplyHyp</span> <span class="id" title="var">H</span>);<br/>
&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="var">iAuIntro</span>.<br/>
<span class="id" title="keyword">Tactic Notation</span> "awp_apply" <span class="id" title="var">open_constr</span>(<span class="id" title="var">lem</span>) "without" <span class="id" title="keyword">constr</span>(<span class="id" title="var">Hs</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_apply_core</span> <span class="id" title="var">lem</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">H</span> =&gt; <span class="id" title="var">iApply</span> <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.program_logic.weakestpre.html#wp_frame_wand_l"><span class="id" title="lemma">wp_frame_wand_l</span></a>; <span class="id" title="var">iSplitL</span> <span class="id" title="var">Hs</span>; [<span class="id" title="var">iAccu</span>|<span class="id" title="var">iApplyHyp</span> <span class="id" title="var">H</span>]);<br/>
&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="var">iAuIntro</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_alloc" <span class="id" title="var">ident</span>(<span class="id" title="var">l</span>) "as" <span class="id" title="keyword">constr</span>(<span class="id" title="var">H</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Htmp</span> := <span class="id" title="var">iFresh</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">finish</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span> [<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> | <span class="id" title="tactic">fail</span> 1 "wp_alloc:" <span class="id" title="var">l</span> "not fresh"];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">pm_reduce</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/stdpp//stdpp.base.html#::type_scope:'False'"><span class="id" title="notation">False</span></a> =&gt; <span class="id" title="tactic">fail</span> 1 "wp_alloc:" <span class="id" title="var">H</span> "not fresh"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">iDestructHyp</span> <span class="id" title="var">Htmp</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>; <span class="id" title="var">wp_finish</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;</div>

<div class="doc">
The code first tries to use allocation lemma for a single reference,
     ie, <span class="inlinecode"><a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_alloc"><span class="id" title="lemma">tac_wp_alloc</span></a></span> (respectively, <span class="inlinecode"><a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_alloc"><span class="id" title="lemma">tac_twp_alloc</span></a></span>).
     If that fails, it tries to use the lemma <span class="inlinecode"><span class="id" title="var">tac_wp_allocN</span></span>
     (respectively, <span class="inlinecode"><span class="id" title="var">tac_twp_allocN</span></span>) for allocating an array.
     Notice that we could have used the array allocation lemma also for single
     references. However, that would produce the resource l ↦∗ <span class="inlinecode"><span class="id" title="var">v</span></span> instead of
     l ↦ v for single references. These are logically equivalent assertions
     but are not equal. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">process_single</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_alloc"><span class="id" title="lemma">tac_wp_alloc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Htmp</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_alloc: cannot find 'Alloc' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">finish</span> ()]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> (<span class="id" title="var">process_single</span> ())<br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">process_single</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_alloc"><span class="id" title="lemma">tac_twp_alloc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Htmp</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_alloc: cannot find 'Alloc' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">finish</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> (<span class="id" title="var">process_single</span> ())<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_alloc: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_alloc" <span class="id" title="var">ident</span>(<span class="id" title="var">l</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">wp_alloc</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> "?".<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_load" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_load: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_load"><span class="id" title="lemma">tac_wp_load</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_load: cannot find 'Load' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_load"><span class="id" title="lemma">tac_twp_load</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_load: cannot find 'Load' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_load: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_store" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_store: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_store"><span class="id" title="lemma">tac_wp_store</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_store: cannot find 'Store' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reduce</span>; <span class="id" title="tactic">first</span> [<span class="id" title="var">wp_seq</span>|<span class="id" title="var">wp_finish</span>]]<br/>
  | |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_store"><span class="id" title="lemma">tac_twp_store</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_store: cannot find 'Store' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reduce</span>; <span class="id" title="tactic">first</span> [<span class="id" title="var">wp_seq</span>|<span class="id" title="var">wp_finish</span>]]<br/>
  | <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_store: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_cmpxchg" "as" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">H1</span>) "|" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">H2</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_cmpxchg: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_cmpxchg"><span class="id" title="lemma">tac_wp_cmpxchg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reduce</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span>; <span class="id" title="var">wp_finish</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">intros</span> <span class="id" title="var">H2</span>; <span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_cmpxchg"><span class="id" title="lemma">tac_twp_cmpxchg</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reduce</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">H1</span>; <span class="id" title="var">wp_finish</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">intros</span> <span class="id" title="var">H2</span>; <span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_cmpxchg: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_cmpxchg_fail" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_cmpxchg_fail: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_cmpxchg_fail"><span class="id" title="lemma">tac_wp_cmpxchg_fail</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg_fail: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">congruence</span>) <span class="comment">(*&nbsp;value&nbsp;inequality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_cmpxchg_fail"><span class="id" title="lemma">tac_twp_cmpxchg_fail</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg_fail: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">congruence</span>) <span class="comment">(*&nbsp;value&nbsp;inequality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_cmpxchg_fail: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_cmpxchg_suc" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_cmpxchg_suc: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_cmpxchg_suc"><span class="id" title="lemma">tac_wp_cmpxchg_suc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg_suc: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">congruence</span>) <span class="comment">(*&nbsp;value&nbsp;equality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reduce</span>; <span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_cmpxchg_suc"><span class="id" title="lemma">tac_twp_cmpxchg_suc</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_cmpxchg_suc: cannot find 'CmpXchg' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> (<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">congruence</span>) <span class="comment">(*&nbsp;value&nbsp;equality&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">try</span> <span class="id" title="var">solve_vals_compare_safe</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reduce</span>; <span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_cmpxchg_suc: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "wp_faa" :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">solve_mapsto</span> <span class="id" title="var">_</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> (?<span class="id" title="var">l</span> <a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">↦{</span></a><span class="id" title="var">_</span><a class="idref" href="intensional.heap_lang.lifting.html#cef1a1f68ad9f7c43249f50e8ee3ceae"><span class="id" title="notation">}</span></a> <span class="id" title="var">_</span>)%<span class="id" title="var">I</span><a class="idref" href="http://coq.inria.fr/distrib/V8.12.1/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> =&gt; <span class="id" title="var">l</span> <span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssumptionCore</span> || <span class="id" title="tactic">fail</span> "wp_faa: cannot find" <span class="id" title="var">l</span> "↦ ?" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">wp_pures</span>;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#wp"><span class="id" title="definition">wp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_wp_faa"><span class="id" title="lemma">tac_wp_faa</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_faa: cannot find 'FAA' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">iSolveTC</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reduce</span>; <span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| |- <a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.proofmode.environments.html#envs_entails"><span class="id" title="definition">envs_entails</span></a> <span class="id" title="var">_</span> (<a class="idref" href="https://plv.mpi-sws.org/coqdoc/iris//iris.bi.weakestpre.html#twp"><span class="id" title="definition">twp</span></a> ?<span class="id" title="var">s</span> ?<span class="id" title="var">E</span> ?<span class="id" title="var">e</span> ?<span class="id" title="var">Q</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">reshape_expr</span> <span class="id" title="var">e</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">K</span> <span class="id" title="var">e'</span> =&gt; <span class="id" title="tactic">eapply</span> (<a class="idref" href="intensional.heap_lang.proofmode.html#tac_twp_faa"><span class="id" title="lemma">tac_twp_faa</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">K</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="tactic">fail</span> 1 "wp_faa: cannot find 'FAA' in" <span class="id" title="var">e</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="var">solve_mapsto</span> ()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">pm_reduce</span>; <span class="id" title="var">wp_finish</span>]<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">fail</span> "wp_faa: not a 'wp'"<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
